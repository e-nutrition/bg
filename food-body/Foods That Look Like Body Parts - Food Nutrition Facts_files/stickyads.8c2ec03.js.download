(window.webpackJsonp=window.webpackJsonp||[]).push([["modules/stickyads"],{"25198250de57e9ac2bf1":function(t,e,n){"use strict";n.r(e),n.d(e,"getScrollTop",(function(){return y})),n.d(e,"Ad",(function(){return p})),n.d(e,"StickyAds",(function(){return v}));var i=n("8d0684f10c3cea737a13"),o=n("891a19eb7d3552f95f46"),r=n("654adc4d2d3e5dbaee18");function s(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}var d=[".article-breaker-ad:not(.mobile-breaker-ad)",".listicle-slide-list-ad"].join(","),u=!!document.querySelector(".sticky-subnav"),h=".content-rail",f="".concat(h,", .right-rail-ad"),g=u?120:90,y=function(){return window.pageYOffset},p=function(){function t(e){l(this,t),this.el=e,this.storeParent(),this.fixedToTop=!0,this.fixedToBottom=!1}return c(t,[{key:"fix",value:function(){var t=this.el.getBoundingClientRect().left,e=document.body.clientWidth-(this.el.offsetWidth+t),n=["position: fixed","top: ".concat(g,"px"),"right: ".concat(e,"px"),"width: auto"].join(";");this.storeParent(),this.el.style.cssText=n,this.fixedToTop=!1,this.fixedToBottom=!1}},{key:"fixToBottom",value:function(t){var e=t-(y()+this.parent.getBoundingClientRect().top);this.el.style.cssText="position: absolute; top: ".concat(e,"px; right:40px;"),this.fixedToBottom=!0}},{key:"unfix",value:function(){this.el.style.cssText="",this.fixedToTop=!0}},{key:"storeParent",value:function(){this.parent=this.el.offsetParent}}]),t}(),v=function(){function t(e){var n=this;l(this,t),this.ads=[],this.el=e,this.fixed=!1,this.scrollTracking=!1,this.lastScrollY=y(),this.logger=new o.a("StickyAds"),this.enabled=!0,this.registerAds(this.el.querySelectorAll(f)),this.observer=Object(r.y)(this.el,this.handleMutation.bind(this),{childList:!0,subtree:!0}),window.addEventListener("glimmer.sticky",(function(){return n.handleStickyVideo()})),window.addEventListener("glimmer.unsticky",(function(){return n.handleUnstickyVideo()})),window.addEventListener("app.nextContentLoaded",(function(){return n.handleNextContentLoaded()})),this.startScrollTracking()}return c(t,null,[{key:"setup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=document.querySelector(e.selector||".content-container");return!n||Modernizr.mobile||Modernizr.tablet?null:new t(n)}}]),c(t,[{key:"handleMutation",value:function(t){var e=s(t.addedNodes).filter((function(t){return t instanceof Element&&t.matches(f)}));e.length&&this.registerAds(e)}},{key:"handleScroll",value:function(t){var e=t>this.lastScrollY?"down":"up";if(this.lastScrollY=t,this.fixed){var n=this.fixed.el;if("down"===e){var i=this.getLowerBoundary(n);t+g>=i&&(this.fixed.fixToBottom(i),this.fixed=null)}else t+g<=this.getUpperBoundary(n)&&(this.fixed.unfix(),this.fixed=null)}else this.checkForAdsToFix(e)}},{key:"handleStickyVideo",value:function(){this.stopScrollTracking();for(var t=0,e=this.ads.length;t<e;t+=1)this.ads[t].unfix();this.fixed=null}},{key:"handleUnstickyVideo",value:function(){this.startScrollTracking()}},{key:"handleNextContentLoaded",value:function(){this.enabled=!1,this.stopScrollTracking();for(var t=0,e=this.ads.length;t<e;t+=1)this.ads[t].unfix();this.fixed=null}},{key:"startScrollTracking",value:function(){this.enabled&&(i.a.on("scroll",this.handleScroll.bind(this),"sticky-ads"),this.scrollTracking=!0)}},{key:"stopScrollTracking",value:function(){i.a.off("scroll","sticky-ads"),this.scrollTracking=!1}},{key:"checkForAdsToFix",value:function(t){for(var e=0,n=this.ads.length;e<n;e+=1){var i=this.ads[e],o=i.el,r=o.getBoundingClientRect(),s=r.bottom,l=r.top;if(s>0&&l<window.innerHeight){if("down"===t?l<=g&&!i.fixedToBottom&&this.getLowerBoundary(o)>this.getUpperBoundary(o):l>=g&&!i.fixedToTop)return i.fix(),void(this.fixed=i)}}}},{key:"registerAds",value:function(t){var e=this;s(t).forEach((function(t){return e.ads.push(new p(t))})),this.logger.log("regiserted new ads",t,this.ads),this.ads.sort((function(t,e){var n=t.el.getBoundingClientRect().top,i=e.el.getBoundingClientRect().top;return n>i?1:i>n?-1:0}))}},{key:"getLowerBoundary",value:function(t){var e,n=t.matches(h)?this.el.querySelector(d):Object(r.o)(t,d);e=n?n.getBoundingClientRect().top:this.el.getBoundingClientRect().bottom,e+=y();var i=Object(r.m)(window.location)?90:window.innerHeight;return e-t.getBoundingClientRect().height-i}},{key:"getUpperBoundary",value:function(t){var e,n=Object(r.s)(t,d);return e=n?n.getBoundingClientRect().bottom+20:this.el.getBoundingClientRect().top,y()+e}}]),t}()}}]);
//# sourceMappingURL=stickyads.8c2ec03.js.map